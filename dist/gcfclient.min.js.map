{"version":3,"sources":["webpack://GcfClient/webpack/universalModuleDefinition","webpack://GcfClient/webpack/bootstrap","webpack://GcfClient/./src/client.js","webpack://GcfClient/(webpack)/buildin/global.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","global","myRoot","self","undefined","GcfClient","constructor","opts","this","_name","win","dom","jQuery","ajax","doc","document","errors","stripe_client","stripe_server","init","decode","str","decodeURIComponent","replace","e","encode","encodeURIComponent","isValid","that","form","queryParseString","qstr","pattern","obj","split","forEach","v","parts","exec","initStripe","stripe","Stripe","style","stripeStyle","elSel","stripeSelector","data","trim","length","elements","card","hidePostalCode","mount","addEventListener","error","$this","message","formId","iQuery","location","href","indexOf","vars","slice","k","val","doAjaxPost","type","url","attr","serialize","done","textStatus","jqXHR","onDone","fail","errorThrown","onFail","always","setTimeout","isSubmitting","getElementsByClassName","on","preventDefault","input","find","grecaptcha","ready","execute","action","then","token","g","Function"],"mappings":"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","file":"gcfclient.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"GcfClient\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"GcfClient\"] = factory();\n\telse\n\t\troot[\"GcfClient\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/**\n * Client-side script for form submission\n *\n * requires: jQuery - todo remove later\n */\nconst myRoot = (typeof self === 'object' && self.self === self && self) ||\n  (typeof global === 'object' && global.global === global && global) ||\n  this\n\nclass GcfClient {\n  constructor(opts = {}) {\n    this._name  = 'GcfClient'\n    this.win    = opts.win || myRoot\n    this.opts   = opts\n    this.dom    = this.win.jQuery\n    this.ajax   = this.dom.ajax\n    this.doc    = this.win.document || {}\n    this.errors = { stripe_client: null, stripe_server: null }\n    this.init()\n  }\n\n  /**\n   * safely decode the string\n   * @param  {string} str\n   * @return {string} url decoded string\n   */\n  decode(str) {\n    try {\n      return decodeURIComponent(str.replace(/\\+/g, ' '))\n    } catch (e) {\n      return str\n    }\n  }\n\n  /**\n   * safely encode the string\n   * @param  {string} str\n   * @return {string} url encoded string\n   */\n  encode(str) {\n    try {\n      return encodeURIComponent(str);\n    } catch (e) {\n      return str;\n    }\n  }\n\n  isValid(that, form) {\n    return true\n  }\n\n  /**\n   * helper method to parse querystring to object\n   * @param  {string} qstr the querystring\n   * @return {object}      result\n   */\n  queryParseString(qstr) {\n    qstr  = (qstr || '').replace('?', '').replace('#', '')\n\n    const pattern = /(\\w+)\\[(\\d+)\\]/\n    const decode  = this.decode,\n          obj     = {},\n          a       = qstr.split('&')\n\n    a.forEach((v) => {\n      const parts = v.split('=')\n      const key   = decode(parts[0])\n      const m     = pattern.exec(key)\n\n      if (m) {\n        obj[m[1]]       = obj[m[1]] || []\n        obj[m[1]][m[2]] = decode(parts[1])\n        return\n      }\n\n      obj[parts[0]] = decode(parts[1] || '')\n    })\n\n    return obj || {}\n  }\n\n  initStripe(form) {\n    const that   = this\n    const opts   = that.opts\n    const win    = that.win\n    const stripe = win.Stripe\n    const style  = opts.stripeStyle\n    const elSel  = opts.stripeSelector || '#stripeElement'\n\n    if (typeof(stripe) === 'function') {\n      const stripeEl = dom(`#${elSel}`)\n      const key      = (stripeEl.data('publickey') || '').trim()\n\n      if (key.length > 2) {\n        that.stripe   = stripe(key);\n        that.elements = that.stripe.elements();\n\n        // Create an instance of the card Element\n        that.card = that.elements.create('card', {\n          style: style,\n          hidePostalCode: true\n        })\n\n        // Add an instance of the card Element into div\n        that.card.mount(`#${elSel}`)\n\n        // Handle real-time validation errors from the card Element.\n        that.card.addEventListener('change', (e) => {\n          that.errors.stripe_client = null\n          that.errors.stripe_server = null\n          if (e.error) {\n            $this.errors.stripe_client = e.error.message;\n          }\n        })\n      }\n    }\n  }\n\n  init() {\n    const that   = this\n    const opts   = that.opts\n    const win    = that.win\n    const dom    = that.dom\n    const formId = opts.formId\n    const iQuery = win.location.href.indexOf('?')\n\n    // auto populate query string to form field\n    if (iQuery > 0) {\n      const vars = that.queryParseString(win.location.href.slice(iQuery + 1))\n\n      for(let k in vars) {\n        if (vars[k]) {\n          dom(`[name=\"${k}\"]`).val(vars[k])\n        }\n      }\n    }\n\n    // handle form submission with ajax\n    // status: \"success\", \"notmodified\", \"nocontent\", \"error\", \"timeout\", \"abort\", or \"parsererror\"\n    const doAjaxPost = (form) => {\n      that.ajax({\n        type: 'POST',\n        mode: 'cors',\n        url: form.attr('action'),\n        data: form.serialize(),\n        done: (data, textStatus, jqXHR) => {\n          if (that.onDone) {\n            that.onDone(data, textStatus, jqXHR)\n          }\n        },\n        fail: (jqXHR, textStatus, errorThrown) => {\n          if (that.onFail) {\n            that.onDone(jqXHR, textStatus, errorThrown)\n          }\n        },\n        always: () => {\n          setTimeout(() => {\n            that.isSubmitting = false\n          }, 200)\n        }\n      })\n    }\n\n    // get the first form\n    let form = dom(document.getElementsByClassName('form')[0])\n    if (formId) {\n      form = dom('#' + formId)\n    }\n\n    // handle form submit\n    form.on('submit', (e) => {\n      // prevent double submits\n      e.preventDefault()\n      if (that.isSubmitting) {\n        return false\n      }\n\n      if (that.isValid(that, form)) {\n        that.isSubmitting = true\n\n        // find captcha input\n        const input = form.find('input[name=\"g-recaptcha-response\"]')\n\n        /* do something to prevent double submit, like disable submit button */\n        if (win.grecaptcha && input.length > 0) {\n          win.grecaptcha.ready(function() {\n            win.grecaptcha.execute(input.data('sitekey'), { action: (input.data('action') || form.attr('id')) })\n            .then(function(token) {\n              input.val(token)\n              doAjaxPost(form)\n            })\n          });\n        } else {\n          doAjaxPost(form)\n        }\n      }\n\n      return false\n    })\n\n    // init strype\n    if (win.Stripe) {\n      that.initStripe(form)\n    }\n  }\n}\n\nexport default GcfClient\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}