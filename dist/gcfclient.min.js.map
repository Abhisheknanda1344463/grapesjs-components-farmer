{"version":3,"sources":["webpack://GcfClient/webpack/universalModuleDefinition","webpack://GcfClient/webpack/bootstrap","webpack://GcfClient/./src/client.js","webpack://GcfClient/(webpack)/buildin/global.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","global","myRoot","self","undefined","GcfClient","constructor","opts","this","_name","win","dom","jQuery","ajax","doc","document","errs","stripe_client","stripe_server","model","init","decode","str","decodeURIComponent","replace","e","encode","encodeURIComponent","validateAll","that","form","validatePhone","validateEmployment","preventNonNumericInput","evt","charCode","event","which","keyCode","preventDefault","stripeResponseHandler","response","error","isSubmitting","message","source","payload","card_brand","card","brand","card_last4","last4","card_month","card_year","pay_token","id","pay_source","JSON","stringify","server","queryParseString","qstr","pattern","obj","split","forEach","v","parts","exec","doAlways","$inputs","setTimeout","prop","doFormSubmit","fd","type","url","attr","data","done","textStatus","jqXHR","onDone","fail","errorThrown","onFail","always","initStripe","stripe","Stripe","style","stripeStyle","elSel","stripeSelector","trim","length","elements","hidePostalCode","mount","addEventListener","safariQuirks","each","_","input","files","formId","iQuery","location","href","indexOf","vars","slice","k","val","doAjaxPost","FormData","serializeArray","ownerInfo","owner","first_name","last_name","address","line1","address1","line2","address2","city","state","postal_code","postal","country","email","createSource","then","rsp","rst","handleStripeResponse","append","getElementsByClassName","on","isValid","phone","amount","employer","occupation","find","grecaptcha","ready","execute","action","token","g","Function"],"mappings":"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","file":"gcfclient.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"GcfClient\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"GcfClient\"] = factory();\n\telse\n\t\troot[\"GcfClient\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/**\n * Client-side script for form submission\n *\n * requires: jQuery - todo remove later\n */\nconst myRoot = (typeof self === 'object' && self.self === self && self) ||\n  (typeof global === 'object' && global.global === global && global) ||\n  this\n\nclass GcfClient {\n  constructor(opts = {}) {\n    this._name = 'GcfClient'\n    this.win   = opts.win || myRoot\n    this.opts  = opts\n    this.dom   = this.win.jQuery\n    this.ajax  = this.dom.ajax\n    this.doc   = this.win.document || {}\n    this.errs  = { stripe_client: null, stripe_server: null }\n    this.model = {}\n    this.init()\n  }\n\n  /**\n   * safely decode the string\n   * @param  {string} str\n   * @return {string} url decoded string\n   */\n  decode(str) {\n    try {\n      return decodeURIComponent(str.replace(/\\+/g, ' '))\n    } catch (e) {\n      return str\n    }\n  }\n\n  /**\n   * safely encode the string\n   * @param  {string} str\n   * @return {string} url encoded string\n   */\n  encode(str) {\n    try {\n      return encodeURIComponent(str);\n    } catch (e) {\n      return str;\n    }\n  }\n\n  validateAll(that, form) {\n    return true\n  }\n\n  validatePhone(that, form) {\n    return true\n  }\n\n  validateEmployment(that, form) {\n    return true\n  }\n\n  /**\n   * Numeric Input event handler\n   *\n   * @param  {Event}  evt the event\n   * @return {Boolean}     false if not number\n   */\n  preventNonNumericInput(evt) {\n    evt = evt || this.win.event\n    var charCode = (evt.which) ? evt.which : evt.keyCode\n\n    if (charCode > 31 && (charCode < 48 || charCode > 57)) {\n      if (charCode === 42) return true\n      evt.preventDefault()\n      return false\n    } else {\n      return true\n    }\n  }\n\n  stripeResponseHandler(response) {\n    if (response.error) {\n      this.isSubmitting       = false\n      this.errs.stripe_server = response.error.message\n      return false\n    }\n\n    const source  = response.source\n    const payload = {}\n\n    if (response.source) {\n      payload.card_brand = source.card.brand\n      payload.card_last4 = source.card.last4\n      payload.card_month = source.card_month\n      payload.card_year  = source.card_year\n      payload.pay_token  = source.id\n      payload.pay_source = JSON.stringify(source)\n    }\n\n    this.errs.server = null\n\n    return payload\n  }\n\n  /**\n   * helper method to parse querystring to object\n   * @param  {string} qstr the querystring\n   * @return {object}      result\n   */\n  queryParseString(qstr) {\n    qstr  = (qstr || '').replace('?', '').replace('#', '')\n\n    const pattern = /(\\w+)\\[(\\d+)\\]/\n    const decode  = this.decode,\n          obj     = {},\n          a       = qstr.split('&')\n\n    a.forEach((v) => {\n      const parts = v.split('=')\n      const key   = decode(parts[0])\n      const m     = pattern.exec(key)\n\n      if (m) {\n        obj[m[1]]       = obj[m[1]] || []\n        obj[m[1]][m[2]] = decode(parts[1])\n        return\n      }\n\n      obj[parts[0]] = decode(parts[1] || '')\n    })\n\n    return obj || {}\n  }\n\n  doAlways(form) {\n    const that    = this\n    const dom     = that.dom\n    const $inputs = dom('input[type=\"file\"]', form)\n\n    setTimeout(() => {\n      // see safariQuirks\n      $inputs.prop('disabled', false)\n      that.isSubmitting = false\n    }, 200)\n  }\n\n  doFormSubmit(form, fd) {\n    const that = this\n\n    that.ajax({\n      type: 'POST',\n      mode: 'cors',\n      url: form.attr('action'),\n      data: fd\n    }).done((data, textStatus, jqXHR) => {\n      if (that.onDone) {\n        that.onDone(data, textStatus, jqXHR)\n      }\n    }).fail((jqXHR, textStatus, errorThrown) => {\n      if (that.onFail) {\n        that.onDone(jqXHR, textStatus, errorThrown)\n      }\n    }).always(() => {\n      that.doAlways(form)\n    })\n  }\n\n  initStripe(form) {\n    const that   = this\n    const opts   = that.opts\n    const win    = that.win\n    const stripe = win.Stripe\n    const style  = opts.stripeStyle\n    const elSel  = opts.stripeSelector || '#stripeElement'\n\n    if (typeof(stripe) === 'function') {\n      const stripeEl = dom(`#${elSel}`)\n      const key      = (stripeEl.data('key') || '').trim()\n\n      if (key.length > 2) {\n        that.stripe   = stripe(key);\n        that.elements = that.stripe.elements();\n\n        // Create an instance of the card Element\n        that.card = that.elements.create('card', {\n          style: style,\n          hidePostalCode: (opts.hidePostalCode || true)\n        })\n\n        // Add an instance of the card Element into div\n        that.card.mount(`#${elSel}`)\n\n        // Handle real-time validation errors from the card Element.\n        that.card.addEventListener('change', (e) => {\n          that.errs.stripe_client = null\n          that.errs.stripe_server = null\n          if (e.error) {\n            that.errs.stripe_client = e.error.message\n          }\n        })\n      }\n    }\n  }\n\n  /**\n   * https://stackoverflow.com/questions/51201011/ios-safari-fails-to-send-form-data-via-ajax/51273135\n   *\n   */\n  safariQuirks(form) {\n    const dom     = that.dom\n    const $inputs = dom('input[type=\"file\"]:not([disabled])', form)\n    $inputs.each((_, input) => {\n      if (input.files.length > 0) return\n      dom(input).prop('disabled', true)\n    })\n  }\n\n  init() {\n    const that   = this\n    const opts   = that.opts\n    const win    = that.win\n    const dom    = that.dom\n    const formId = opts.formId\n    const iQuery = win.location.href.indexOf('?')\n\n    // auto populate query string to form field\n    if (iQuery > 0) {\n      const vars = that.queryParseString(win.location.href.slice(iQuery + 1))\n\n      for(let k in vars) {\n        if (vars[k]) {\n          dom(`[name=\"${k}\"]`).val(vars[k])\n        }\n      }\n    }\n\n    // handle form submission with ajax\n    // status: \"success\", \"notmodified\", \"nocontent\", \"error\", \"timeout\", \"abort\", or \"parsererror\"\n    const doAjaxPost = (form) => {\n      // serialize form\n      that.safariQuirks(form)\n      const fd = new FormData(form)\n\n      // if no payment then simply submit\n      if (!that.card) {\n        return that.doFormSubmit(form, fd)\n      }\n\n      // otherwise, process stripe charge\n      const model = {}\n\n      // we use form serializeArray to provide better browser support\n      // as FormData is not compatible with many browsers\n      const fa    = form.serializeArray()\n\n      // convert to object\n      fa.forEach((value, key) => {\n        model[key] = value;\n      })\n\n      // compose payload for stripe\n      const ownerInfo = {\n        owner: {\n          name: model.first_name + ' ' + model.last_name,\n          address: {\n            line1: model.address1,\n            line2: model.address2,\n            city: model.city,\n            state: model.state,\n            postal_code: model.postal,\n            country: model.country\n          },\n          email: model.email\n        }\n      }\n\n      // send to stripe\n      that.stripe.createSource(that.card, ownerInfo)\n        .then((rsp) => {\n          let rst = that.handleStripeResponse(rsp)\n          if (rst) {\n            // append result to form data\n            for(let k in rst) {\n              fd.append(k, rst[k])\n            }\n\n            that.doFormSubmit(form, fd)\n          } else {\n            that.doAlways(form)\n          }\n        });\n    }\n\n    // get the first form\n    let form = dom(document.getElementsByClassName('form')[0])\n    if (formId) {\n      form = dom('#' + formId)\n    }\n\n    // handle form submit\n    form.on('submit', (e) => {\n      // prevent double submits\n      e.preventDefault()\n      if (that.isSubmitting) {\n        return false\n      }\n\n      that.validateAll(that, form)\n      that.validatePhone(that, form)\n      that.validateEmployment(that, form)\n\n      const errs  = that.errs\n      let isValid = that.errs.length <= 0\n\n      isValid = isValid && !errs.phone && !errs.amount && !errs.stripe_client && !errs.stripe_server\n      isValid = isValid && !errs.employer && !errs.occupation\n\n      if (isValid) {\n        that.isSubmitting = true\n\n        // find captcha input\n        const input = form.find('input[name=\"g-recaptcha-response\"]')\n\n        /* do something to prevent double submit, like disable submit button */\n        if (win.grecaptcha && input.length > 0) {\n          win.grecaptcha.ready(() => {\n            win.grecaptcha.execute(input.data('sitekey'), { action: (input.data('action') || form.attr('id')) })\n            .then((token) => {\n              input.val(token)\n              doAjaxPost(form)\n            })\n          });\n        } else {\n          doAjaxPost(form)\n        }\n      }\n\n      return false\n    })\n\n    // init strype\n    if (win.Stripe) {\n      that.initStripe(form)\n    }\n  }\n}\n\nexport default GcfClient\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}