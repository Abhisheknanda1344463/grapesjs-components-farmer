/*! For license information please see gcfclient.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("GcfClient",[],t):"object"==typeof exports?exports.GcfClient=t():e.GcfClient=t()}(self,(function(){return function(){"use strict";var e={754:function(e,t,r){r.r(t);const n="object"==typeof self&&self.self===self&&self||"object"==typeof r.g&&r.g.global===r.g&&r.g||void 0;t.default=class{constructor(e={}){this._name="GcfClient",this.win=e.win||n,this.opts=e,this.dom=this.win.jQuery,this.ajax=this.dom.ajax,this.doc=this.win.document||{},this.errs=[],this.model={},this.opts.stripe=e.stripe||{hidePostalCode:!1,style:{}},this.opts.stripe.style={base:{lineHeight:"1.49"},...e.stripe.style},this.init()}decode(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}}encode(e){try{return encodeURIComponent(e)}catch(t){return e}}validateAll(e,t){return!0}validatePhone(e,t){return!0}validateEmployment(e,t){return!0}preventNonNumericInput(e){var t=(e=e||this.win.event).which?e.which:e.keyCode;return!(t>31&&(t<48||t>57)&&42!==t&&(e.preventDefault(),1))}stripeResponseHandler(e){if(e.error)return this.isSubmitting=!1,this.errs.stripe_server=e.error.message,!1;const t=e.source,r={};return e.source&&(r.card_brand=t.card.brand,r.card_last4=t.card.last4,r.card_month=t.card.month,r.card_year=t.card.year,r.pay_token=t.id,r.pay_source=JSON.stringify(t)),this.errs.server=null,r}queryParseString(e){e=(e||"").replace("?","").replace("#","");const t=/(\w+)\[(\d+)\]/,r=this.decode,n={};return e.split("&").forEach((e=>{const i=e.split("="),o=r(i[0]),s=t.exec(o);if(s)return n[s[1]]=n[s[1]]||[],void(n[s[1]][s[2]]=r(i[1]));n[i[0]]=r(i[1]||"")})),n||{}}doAlways(e){const t=this,r=(0,t.dom)('input[type="file"]',e[0]);setTimeout((()=>{r.prop("disabled",!1),t.isSubmitting=!1}),200)}doFormSubmit(e,t){const r=this;r.ajax({mode:"cors",cache:!1,contentType:!1,processData:!1,method:"POST",type:"POST",url:e.attr("action"),data:t}).done(((e,t,n)=>{r.onDone&&r.onDone(e,t,n)})).fail(((e,t,n)=>{r.onFail&&r.onDone(e,t,n)})).always((()=>{r.doAlways(e)}))}initStripe(e){const t=this,r=t.opts,n=t.win,i=t.dom,o=n.Stripe,s=r.stripeSelector||"#stripeElement";if("function"==typeof o){const e=i(s),n=(e.data("key")||"").trim(),a=e.data("hide-postal");n.length>2&&(t.stripe=o(n),t.elements=t.stripe.elements(),t.card=t.elements.create("card",{style:r.stripe.style,hidePostalCode:a}),t.card.mount(s),t.card.addEventListener("change",(e=>{t.errs.stripe_client=null,t.errs.stripe_server=null,e.error&&(t.errs.stripe_client=e.error.message)})))}}safariQuirks(e){const t=this.dom,r=t('input[type="file"]:not([disabled])',e[0]);r.length>0&&r.each(((e,r)=>{r.files.length>0||t(r).prop("disabled",!0)}))}init(){const e=this,t=e.opts,r=e.win,n=e.dom,i=t.formId,o=r.location.href.indexOf("?");if(o>0){const t=e.queryParseString(r.location.href.slice(o+1));for(let e in t)t[e]&&n(`[name="${e}"]`).val(t[e])}const s=t=>{e.safariQuirks(t);const r=new FormData(t[0]);if(!e.card)return e.doFormSubmit(t,r);const n={};t.serializeArray().forEach(((e,t)=>{n[t]=e}));const i={owner:{name:n.name,email:n.email}};n.address1&&(i.owner.address={line1:n.address1,line2:n.address2,city:n.city,state:n.state,postal_code:n.postal,country:n.country}),n.first_name&&(i.name=n.first_name+" "+n.last_name),e.stripe.createSource(e.card,i).then((n=>{let i=e.stripeResponseHandler(n);if(i){for(let e in i)r.append(e,i[e]);e.doFormSubmit(t,r)}else e.doAlways(t)}))};let a=n(document.forms[0]);i&&(a=n("#"+i)),a.on("submit",(t=>{if(t.preventDefault(),e.isSubmitting)return!1;e.validateAll(e,a),e.validatePhone(e,a),e.validateEmployment(e,a);const n=e.errs;let i=e.errs.length<=0;if(i=i&&!n.phone&&!n.amount&&!n.stripe_client&&!n.stripe_server,i=i&&!n.employer&&!n.occupation,i){e.isSubmitting=!0;const t=a.find('input[name="g-recaptcha-response"]');r.grecaptcha&&t.length>0?r.grecaptcha.ready((()=>{r.grecaptcha.execute(t.data("sitekey"),{action:t.data("action")||a.attr("id")}).then((e=>{t.val(e),s(a)}))})):s(a)}return!1})),r.Stripe&&e.initStripe(a)}}}},t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}return r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(754)}()}));
//# sourceMappingURL=gcfclient.min.js.map